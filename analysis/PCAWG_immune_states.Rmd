---
title: "Immune states in PCAWG"
output:
  html_document:
    df_print: paged
---

```{r}
knitr::opts_chunk$set(comment = '', fig.width = 6, 
                      fig.height = 6, echo = FALSE, 
                      warning = FALSE)
```


```{r load-packages}
library(here)
fig.dir = here("figures/immune_analysis")

if(! file.exists(fig.dir)){
    dir.create(fig.dir, recursive = TRUE)
}

source(here("R/load_packages.R"))
```

<!-- ```{r loading} -->
<!-- mutated.pathways.tissues = readRDS(file = here("data/RDS/PCAWG/10_onco_pathways", -->
<!--                                               "pcawg_pathways.RDS")) -->

<!-- PCAWG.full.subset.ann.pathways = readRDS(file = here("data/RDS/PCAWG/10_onco_pathways", -->
<!--                                               "PCAWG.full.subset.ann.pathways.RDS")) -->
<!-- ``` -->


```{r}
immune.states = readRDS(file = file.path(out.dir, "pcawg_immune_states.RDS"))

PCAWG.full.subset.ann.immune= readRDS(
    file = file.path(out.dir, "PCAWG.full.subset.ann.immune.RDS"))
```

### Summary of immune states

```{r}
table(immune.states[, c("RF", "DN")]) %>% 
    as.data.frame() %>% 
    ggplot(aes(x = RF, y = DN, fill = Freq)) + 
    geom_tile() + 
    geom_text(aes(label = Freq), color = "white") + 
    scale_fill_viridis()
```

